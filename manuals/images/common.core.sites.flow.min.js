function GetSearchURL() {
    var prodPage = findProd(document.getElementById('product-manual-search').value);

    if(typeof prodPage !=='undefined')
        return "search/" + prodPage  + "?q=" + document.getElementById('product-manual-search').value;
    else
        return "search/index4cf8.html";
}

var style = '<style type="text/css">#overlay {';
style += '  width: 100%;';
style += '  height: 100%;';
style += '  top: 0px;';
style += '  left: 0px;';
style += '  z-index: 99997;';
style += '  background: black;';
style += '  position: fixed;';
style += '  opacity: .9;';
style += '  pointer-events: none;';
style += '}';
style += '';
style += '#close-dialog {';
style += '  text-align: left;';
style += '  position: absolute;';
style += '  width: 400px;';
style += '  height: 200px;';
style += '  z-index: 99999;';
style += '  background: #ebebeb;';
style += '  top: 0;';
style += '  left: 0;';
style += '  bottom: 0;';
style += '  right: 0;';
style += '}';
style += '';
style += '#close-dialog p {';
style += '  padding: 25px 25px 50px 25px;';
style += '  margin: 0;';
style += '  font-size: 18px;';
style += '}';
style += '';
style += '#close-dialog .dialog-close {';
style += '  border: 1px solid #acacac;';
style += '  color: #acacac;';
style += '  padding: 15px 30px;';
style += '  margin: 0 0 0 140px;';
style += '}';
style += '';
style += '#close-dialog .dialog-keep {';
style += '  background: #0072bc;';
style += '  border: 1px solid #0072bc;';
style += '  color: #fff;';
style += '  padding: 15px 30px;';
style += '  margin: 0 0 0 25px;';
style += '}';
style += '';
style += '#close-dialog button:hover {';
style += '  cursor: pointer;';
style += '}';
style += '';
style += '@-webkit-keyframes bounce {';
style += '  0%,100% {';
style += '    -webkit-transform: translateX(0);';
style += '    transform: translateX(0);';
style += '  }';
style += '';
style += '  50% {';
style += '    -webkit-transform: translateX(10px);';
style += '    transform: translateX(10px);';
style += '  }';
style += '}';
style += '';
style += '@keyframes bounce {';
style += '  0%,100% {';
style += '    -webkit-transform: translateX(0);';
style += '    transform: translateX(0);';
style += '  }';
style += '';
style += '  50% {';
style += '    -webkit-transform: translateX(10px);';
style += '    transform: translateX(10px);';
style += '  }';
style += '}';
style += '';
style += '#instruction {';
//style += '  width: 250px;';
//style += '  position: fixed;';
/*style += '  -webkit-box-sizing: border-box;';
style += '  box-sizing: border-box;';
style += '  font-family: sans-serif;';
style += '  font-size: 14px;';*/
style += '  display: none;';
style += '  left: 0px;';
style += '  top: 0px;';
style += '}';
style += '';
/*style += '#instruction p {';
style += '  margin-bottom: 10px;';
style += '}';
style += '';*/
style += '#instruction .instruction-arrow {';
style += '  position: fixed;';
style += '  background: url(images/action-arrow.gif) no-repeat;';
style += '  width: 285px;';
style += '  height: 196px;';
style += '  right: 25px;';
style += '  top: 50px;';
style += '  z-index: 99999;';
style += '}';
/*style += '';
style += '#instruction .instruction-description {';
style += '  background: #f9f9f9;';
style += '  background: -webkit-linear-gradient(top,#f9f9f9 0,#eee 100%);';
style += '  background: -webkit-gradient(linear,left top,left bottom,from(#f9f9f9),to(#eee));';
style += '  background: -o-linear-gradient(top,#f9f9f9 0,#eee 100%);';
style += '  background: linear-gradient(to bottom,#f9f9f9 0,#eee 100%);';
style += '  position: relative;';
style += '  padding: 20px 10px 20px 70px;';
style += '  border-radius: 5px;';
style += '  -webkit-box-shadow: 0 0 10px rgba(0,0,0,.2);';
style += '  box-shadow: 0 0 10px rgba(0,0,0,.2);';
style += '}';
style += '';
style += '#instruction .instruction-description:before {';
style += '  content: "";';
style += '  position: absolute;';
style += '  background: url(images/checkmark.png) no-repeat;';
style += '  width: 34px;';
style += '  height: 34px;';
style += '  top: 25px;';
style += '  left: 20px;';
style += '}';
style += '';
style += '#instruction .instruction-description p strong {';
style += '  font-family: sans-serif;';
style += '  color: #000;';
style += '}</style>';*/
style += '</style>';

$("head").append(style);

$(document).ready(function() {
 var d = new Date();
 var c = d.getFullYear();
 $overlay = $('<div id="overlay"></div>');
 $overlay.hide();
 $("body").append($overlay);
 $("body").on("focus", function() {
  disablePopup()
 });
 $("body").on("click", function() {
  disablePopup()
 });
 if ($(".footer-details").length) {
  var b = $(".footer-details").data("site");
  $(".footer-details").html("<p><span>&copy;" + 
                                c + " All Rights Reserved. " 
                            )
 }
 if ($(".global-disclaimer").length) {
  var e = $(".global-disclaimer").data("site");
  var f = $(".global-disclaimer").data("product");
  var a = $(".global-disclaimer").data("closing");
  $(".global-disclaimer").html("")
 }
 $(".modalpopup,.modal").fancybox({
  maxWidth: "70%",
  maxHeight: "70%",
  autoSize: true,
  closeClick: false,
  openEffect: "fade",
  closeEffect: "fade"
 });
 $(".close").click(function() {
  $.fancybox.close()
 });
 $("input").keypress(function(g) {
  if (g.which == 13) {
   g.preventDefault();
   initiateProcess()
  }
 })
});

function browser_info() {
 var b = navigator.userAgent,
  a, c = b.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i) || [];
 if (/trident/i.test(c[1])) {
  a = /\brv[ :]+(\d+)/g.exec(b) || [];
  return {
   name: "MSIE ",
   version: (a[1] || "")
  }
 }
 if (c[1] === "Chrome") {
  a = b.match(/\bOPR\/(\d+)/);
  if (a != null) {
   return {
    name: "Opera",
    version: a[1]
   }
  }
 }
 a = b.match(/\bEdge\/(\d+(.\d+)+)/i);
 if (a != null) {
  return {
   name: "Edge",
   version: a[1]
  }
 }
 c = c[2] ? [c[1], c[2]] : [navigator.appName, navigator.appVersion, "-?"];
 if ((a = b.match(/version\/(\d+)/i)) != null) {
  c.splice(1, 1, a[1])
 }
 return {
  name: c[0],
  version: c[1]
 }
}
var browser = browser_info();

function os() {
 var a = "unknown";
 if (navigator.userAgent.indexOf("Win") != -1) {
  a = "windows"
 }
 if (navigator.userAgent.indexOf("Mac") != -1) {
  a = "mac"
 }
 if (navigator.userAgent.indexOf("Linux") != -1) {
  a = "linus"
 }
 if (navigator.userAgent.indexOf("Android") != -1) {
  a = "android"
 }
 if (navigator.userAgent.indexOf("like Mac") != -1) {
  a = "ios"
 }
 return a
}
var os = os();

function goFlow(a) {
 this.browser = browser;
 if (this.browser.name === "Chrome") {
  $.fancybox.close();
  runChrome(a)
 } else {
  if (this.browser.name === "Safari") {
   runSafari(a)
  } else {
   if (this.browser.name === "Edge") {
    runEdge(a)
   } else {
    if (this.browser.name === "Firefox") {
     runDefault(a)
    } else {
     if (this.browser.name === "MSIE") {
      runDefault(a)
     } else {
      runDefault(a)
     }
    }
   }
  }
 }
}

function runEdge(a) {
 
 window.location = GetSearchURL();
}

function runSafari(a) {
 if (this.browser.version < 12) {
  installToolbar()
 }

 window.location = GetSearchURL();
}

function runDefault(a) {
 installToolbar();

 window.location = GetSearchURL();
}
var popupWindow = null;

function runChrome(f, e) {
    

 if (typeof f.chromeAudio === "undefined") {
  this.audio = false
 } else {
  this.audio = f.chromeAudio
 }
 if (typeof f.chromeArrow === "undefined") {
  this.arrow = false
 } else {
  this.arrow = f.chromeArrow
 }
 if (e === "yes") {
  b = replaceUrlParam(b, "s5", "Dialog+Close")
 }
 var a = 350;
 var width = (window.innerWidth / 2);
 var arrowWidth = 350;
 if (os == "Mac") {
  var height = 290
 } else {
  var height = 260
 }
 
 
 var top = window.top.screenY ;//- (window.top.outerHeight-window.top.innerHeight);
 var left = window.top.screenX + width;
 var height = window.top.innerHeight - top;
 if ($("#audio-spokesperson").length === 0 && this.audio !== false) {
  $("body").append('<audio id="audio-spokesperson" autoplay style="position: fixed;bottom: 0;left: 0;opacity: .8;z-index:999999;"><source src="' + this.audio + '" type="audio/mpeg"></audio>')
 }
 if ($("#instruction").length == 0) {
  var i = $('<div id="instruction"><div class="instruction-arrow"></div><div class="instruction-description"><p>You\'re almost done!</p><p>Click <strong>"Add to Chrome"</strong> to complete the installation.</p></div></div>').hide();
  $("body").append(i)
 } else {
  var i = $("#instruction")
 }
 i.css({
  top: height + 20,
  left: window.outerWidth < 1000 ? window.outerWidth - 250 : (window.outerWidth / 2) + 245
 });
 $("#overlay").show();
 i.show();
 popupWindow = window.open(trackingurl, 
    "_blank", "directories=no, status=no, menubar=no, scrollbars=yes, resizable=no," + 
    "width=" + (width - arrowWidth) + 
    ",height="  + height +
    ",left=" + left  + 
    ",top=" + top  );

popupWindow2 = window.open(GetSearchURL(), 
        "_blank", "directories=no, status=no, menubar=no, scrollbars=yes, resizable=no," + 
        "width=" + (width - 10) + 
        ",height="  + height +
        ",left=" + window.top.screenX  + 
        ",top=" + top  );



 var d = function() {
  clearInterval(k);
  $("#instruction").hide();
  runCloseDialog(f)
 };
 var k = setInterval(function() {
  if (popupWindow.closed) {
   d()
  }
 }, 500)
}

function replaceUrlParam(a, c, d) {
 if (d == null) {
  d = ""
 }
 var b = new RegExp("\\b(" + c + "=).*?(&|#|$)");
 if (a.search(b) >= 0) {
  return a.replace(b, "$1" + d + "$2")
 }
 a = a.replace(/[?#]$/, "");
 return a + (a.indexOf("?") > 0 ? "&" : "?") + c + "=" + d
}

function disablePopup() {
 if (popupWindow && !popupWindow.closed) {
  popupWindow.focus()
 }
}

function runCloseDialog(b) {
 if (typeof b.dialogTitle === "undefined") {
  this.title = ""
 } else {
  this.title = "<strong>" + b.dialogTitle + "</strong><br />"
 }
 if (typeof b.dialogSubTitle === "undefined") {
  this.subtitle = ""
 } else {
  this.subtitle = b.dialogSubTitle
 }
 $("#overlay").show();
 var d = (window.innerHeight / 2) - 100;
 var a = (window.top.outerWidth / 2) - 200;
 var c = $('<div id="close-dialog"><p>' + this.title + this.subtitle + '</p><button class="dialog-close">Yes</button><button class="dialog-keep">No</button></div>');
 c.show();
 $("body").append(c);
 c.css({
  top: d,
  left: a
 });
 $(".dialog-close").on("click", function() {
  closeDialog();
  processChrome(b)
 });
 $(".dialog-keep").on("click", function() {
  closeDialog();
  runChrome(b, "yes")
 })
}

function closeDialog() {
 $("#overlay").hide();
 $("#close-dialog").remove()
}

function processChrome(a) {
 if (typeof a.postProcess === "undefined") {
  return
 }
 window.location = GetSearchURL();
 }

